<!DOCTYPE html>
<html>
    <link rel="stylesheet" href="css/main.css"/>
    <script type="text/javascript" src="js/jquery-1.5.1.min.js"></script>
    <script type="text/javascript" src="js/layers.js"></script>
<body>
    <div id="main"></div>
    <div id="layers">
        <div class="layer" data-id="0">
            <div class="gradientSample"></div>
            <fieldset class="orientation">
                <legend>Orientation</legend>
                <label>Rotation</label><input name="rotation" type="number" value="0"/>deg
            </fieldset>
            <fieldset class="size">
                <legend>Size</legend>
                <label>Width</label><input name="width" type="number" value="0"/>px
                <label>Height</label><input name="height" type="number" value="0"/>px
            </fieldset>
            <fieldset class="position">
                <legend>Position</legend>
                <label>x</label><input name="x" type="number" value="0"/>px
                <label>y</label><input name="y" type="number" value="0"/>px
            </fieldset>
        </div>
        <div class="layer" data-id="1">
            <div class="gradientSample"></div>
            <fieldset class="orientation">
                <legend>Orientation</legend>
                <label>Rotation</label><input name="rotation" type="number" value="0"/>deg
            </fieldset>
            <fieldset class="size">
                <legend>Size</legend>
                <label>Width</label><input name="width" type="number" value="0"/>px
                <label>Height</label><input name="height" type="number" value="0"/>px
            </fieldset>
            <fieldset class="position">
                <legend>Position</legend>
                <label>x</label><input name="x" type="number" value="0"/>px
                <label>y</label><input name="y" type="number" value="0"/>px
            </fieldset>
        </div>
        
        <textarea id="data"></textarea>
    </div>
    
    
    
    <script>
    
        var testGrad1 = new GW.linearGradient(new GW.point('top')).addStop(new GW.stop('rgba(255,0,0,1)')).addStop(new GW.stop('rgba(0,0,255,0)'));
        var testGrad2 = new GW.linearGradient(new GW.point('top')).addStop(new GW.stop('rgba(0,255,0,1)')).addStop(new GW.stop('rgba(0,0,0,0)'));
        
        var layers = new GW.layers();
        layers.push(new GW.layer(testGrad1));
        layers.push(new GW.layer(testGrad2));
    
        $('.layer .gradientSample').each(function() {
            var id = $(this).parents('.layer').attr('data-id');
            $(this).css('background-image',layers[id].gradient);
        });
    
        $('#layers .orientation input').live('change', function(e) {
            var id = $(this).parents('.layer').attr('data-id');
            layers[id].gradient.orientation = new GW.angle(this.value); 
        });
        
        $('#layers .size input').live('change', function(e) {
            var id = $(this).parents('.layer').attr('data-id');
            layers[id].size = new GW.point($(this).parent().find('input[name=width]').val() + 'px', $(this).parent().find('input[name=height]').val() + 'px'); 
        });
        
         $('#layers .position input').live('change', function(e) {
            var id = $(this).parents('.layer').attr('data-id');
            layers[id].position = new GW.point($(this).parent().find('input[name=x]').val() + 'px', $(this).parent().find('input[name=y]').val() + 'px'); 
        });
        
        $('#layers input').live('change', function(e) {
            var parent = $(this).parents('.layer');
            $(parent).find('.gradientSample').css('background-image',layers[parent.attr('data-id')].gradient);
            $('#main').css('background-image',layers.getImage());
            $('#main').css('background-size',layers.getSize());
            $('#main').css('background-position',layers.getPosition());
            $('#data').html(JSON.stringify(layers));
        });
    
        
        
    
    </script>
    
</body>
</html>